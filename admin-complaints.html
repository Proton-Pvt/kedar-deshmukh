<h2>Customer Complaints</h2>
<div id="list"></div>
<button onclick="updateStatus('${doc.id}','In Progress')">In Progress</button>
<button onclick="updateStatus('${doc.id}','Resolved')">Resolved</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { 
  getFirestore, collection, onSnapshot, orderBy, query 
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCrj_dMhYpdRZeKIYTAckYdqGE4f0FBz8w",
  authDomain: "restaurant-database-1ca9d.firebaseapp.com",
  projectId: "restaurant-database-1ca9d",
  storageBucket: "restaurant-database-1ca9d.firebasestorage.app",
  messagingSenderId: "772678372956",
  appId: "1:772678372956:web:1e517b1f963d58f3c1a099"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const list = document.getElementById("list");

const q = query(collection(db, "complaints"), orderBy("createdAt", "desc"));
onSnapshot(q, (snapshot) => {
  list.innerHTML = "";
  snapshot.forEach(doc => {
    const d = doc.data();
    list.innerHTML += `
      <div style="padding:12px;border:1px solid #ccc;margin:10px 0;border-radius:8px;">
        <b>Phone:</b> ${d.phone}<br>
        <b>Description:</b> ${d.description}<br>
        <b>Status:</b> ${d.status}<br>
        ${d.imageBase64 ? `<img src="${d.imageBase64}" width="200">` : ""}
      </div>
    `;
  });
});
import { doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

window.updateStatus = async (id, status) => {
  await updateDoc(doc(db, "complaints", id), {
    status: status
  });
  alert("Status updated to " + status);
};

</script>
